apiVersion: v1
kind: ConfigMap
metadata:
  name: kafka-config
  namespace: {{ .Values.global.namespace }}
data:
  bootstrap.servers: {{ .Values.kafka.bootstrapServers | quote }}
  {{- if .Values.kafka.securityProtocol }}
  security.protocol: {{ .Values.kafka.securityProtocol | quote }}
  {{- end }}
  {{- if .Values.kafka.saslMechanism }}
  sasl.mechanism: {{ .Values.kafka.saslMechanism | quote }}
  {{- end }}

  # Topics
  topics.user-events: {{ .Values.kafka.topics.userEvents | quote }}
  topics.tenant-events: {{ .Values.kafka.topics.tenantEvents | quote }}
  topics.provider-events: {{ .Values.kafka.topics.providerEvents | quote }}
  topics.service-catalog-events: {{ .Values.kafka.topics.serviceCatalogEvents | quote }}
  topics.booking-events: {{ .Values.kafka.topics.bookingEvents | quote }}

  # Producer settings
  producers.acks: {{ .Values.kafka.producers.acks | quote }}
  producers.enableIdempotence: {{ .Values.kafka.producers.enableIdempotence | quote }}
  producers.messageTimeoutMs: {{ .Values.kafka.producers.messageTimeoutMs | quote }}
  producers.requestTimeoutMs: {{ .Values.kafka.producers.requestTimeoutMs | quote }}

  # Consumer settings
  consumers.enableAutoCommit: {{ .Values.kafka.consumers.enableAutoCommit | quote }}
  consumers.autoOffsetReset: {{ .Values.kafka.consumers.autoOffsetReset | quote }}

  # Azure Event Hubs compatibility settings
  api.version.request: "false"
  broker.version.fallback: "1.0.0"